From c82ca2db20b38b964b0db6a16e87619a85632c97 Mon Sep 17 00:00:00 2001
From: Zoraver Kang <zkang@wpi.edu>
Date: Thu, 22 Aug 2019 01:24:00 -0400
Subject: [PATCH 48/50] enable subresource filter on all sites

---
 .../core/browser/subresource_filter_features.cc     | 13 ++++++++++++-
 .../core/browser/subresource_filter_features.h      |  2 ++
 2 files changed, 14 insertions(+), 1 deletion(-)

diff --git a/components/subresource_filter/core/browser/subresource_filter_features.cc b/components/subresource_filter/core/browser/subresource_filter_features.cc
index 6e2b5e1c5f2e..699638f12cb1 100644
--- a/components/subresource_filter/core/browser/subresource_filter_features.cc
+++ b/components/subresource_filter/core/browser/subresource_filter_features.cc
@@ -128,7 +128,9 @@ std::vector<Configuration> FillEnabledPresetConfigurations(
       {kPresetPerformanceTestingDryRunOnAllSites, ad_tagging_enabled,
        &Configuration::MakePresetForPerformanceTestingDryRunOnAllSites},
       {kPresetLiveRunForBetterAds, true,
-       &Configuration::MakePresetForLiveRunForBetterAds}};
+       &Configuration::MakePresetForLiveRunForBetterAds},
+      {kPresetLiveRunOnAllSites, true,
+       &Configuration::MakePresetForLiveRunOnAllSites}};
 
   CommaSeparatedStrings enabled_presets(
       TakeVariationParamOrReturnEmpty(params, kEnablePresetsParameterName));
@@ -270,6 +272,7 @@ const char kPresetPerformanceTestingDryRunOnAllSites[] =
     "performance_testing_dryrun_on_all_sites";
 const char kPresetLiveRunForBetterAds[] =
     "liverun_on_better_ads_violating_sites";
+const char kPresetLiveRunOnAllSites[] = "liverun_on_all_sites";
 
 // Configuration --------------------------------------------------------------
 
@@ -300,6 +303,14 @@ Configuration Configuration::MakePresetForLiveRunForBetterAds() {
   return config;
 }
 
+// static
+Configuration Configuration::MakePresetForLiveRunOnAllSites() {
+  Configuration config(mojom::ActivationLevel::kEnabled,
+                       ActivationScope::ALL_SITES);
+  config.activation_conditions.priority = 600;
+  return config;
+}
+
 Configuration::Configuration() = default;
 Configuration::Configuration(mojom::ActivationLevel activation_level,
                              ActivationScope activation_scope,
diff --git a/components/subresource_filter/core/browser/subresource_filter_features.h b/components/subresource_filter/core/browser/subresource_filter_features.h
index 72549240ceca..a70a923b701b 100644
--- a/components/subresource_filter/core/browser/subresource_filter_features.h
+++ b/components/subresource_filter/core/browser/subresource_filter_features.h
@@ -122,6 +122,7 @@ struct Configuration {
   static Configuration MakePresetForLiveRunOnPhishingSites();
   static Configuration MakePresetForPerformanceTestingDryRunOnAllSites();
   static Configuration MakePresetForLiveRunForBetterAds();
+  static Configuration MakePresetForLiveRunOnAllSites();
 
   ActivationConditions activation_conditions;
   ActivationOptions activation_options;
@@ -219,6 +220,7 @@ extern const char kDisablePresetsParameterName[];
 extern const char kPresetLiveRunOnPhishingSites[];
 extern const char kPresetPerformanceTestingDryRunOnAllSites[];
 extern const char kPresetLiveRunForBetterAds[];
+extern const char kPresetLiveRunOnAllSites[];
 
 }  // namespace subresource_filter
 
-- 
2.21.0

